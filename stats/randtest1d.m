function out = randtest1d(a,b,tail,nrand)% function out = randtest1d(a,b,tail,nrand);% tail = 0 (test A~=B), 1 (test A>B), -1 (test A<B)if ~exist('b', 'var'),   b = zeros(size(a)); endif ~exist('nrand', 'var'), nrand = 10000; endif ~exist('tail', 'var'), tail = 0; enda = a(:);b = b(:);ntra = length(a);ntrb = length(b);meana = mean(a);meanb = mean(b);alldat = [a;b];triala = zeros(nrand);trialb = triala;for irand = 1:nrand,    [~, ind]      = sort(rand(ntra+ntrb,1));    triala(irand) = mean(alldat(ind(1:ntra)));    trialb(irand) = mean(alldat(ind(ntra+1:end)));endswitch tail    case 0        out = length(find(abs(triala-trialb) >= abs(meana-meanb)))/nrand;    case {-1,1}        out = length(find(tail*(triala-trialb) >= tail*(meana-meanb)))/nrand;end